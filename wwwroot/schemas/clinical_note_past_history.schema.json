{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://example.com/clinical-note-past-history.schema.json",
	"title": "Clinical Note Past History Schema",
	"type": "object",
	"properties": {
		"pastMedicalHistory": {
			"type": "object",
			"properties": {
				"COPD": {
					"type": "object",
					"$comment": "Chronic Obstructive Pulmonary Disease",
					"properties": {
						"diagnosed": { "type": "boolean" },
						"diagnosisMethod": {
							"type": "object",
							"properties": {
								"PFT": {
									"type": "object",
									"$comment": "Pulmonary Function Test",
									"properties": {
										"FEV1": {
											"type": ["number", "null"],
											"minimum": 0,
											"maximum": 10,
											"description": "Forced Expiratory Volume in 1 second, measured in liters"
										},
										"FVC_FEV1_ratio": {
											"type": ["number", "null"],
											"minimum": 0,
											"maximum": 1,
											"description": "Ratio of Forced Vital Capacity to FEV1, expressed as a decimal (0-1)"
										},
										"ventolinResponse": {
											"type": ["string", "null"],
											"description": "Patient response to Ventolin bronchodilator"
										}
									},
									"additionalProperties": false
								}
							},
							"additionalProperties": false
						},
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date"
						},
						"respirologist": { "type": ["string", "null"] }
					},
					"required": ["diagnosed"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"diagnosed": { "const": false }
						}
					},
					"then": {
						"properties": {
							"diagnosed": {},
							"diagnosisMethod": { "not": {} },
							"lastHospitalization": { "not": {} },
							"respirologist": { "not": {} }
						}
					}
				},

				"CKD": {
					"type": "object",
					"$comment": "Chronic Kidney Disease",
					"properties": {
						"previousDialysis": { "type": "boolean" },
						"kidneyMedications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"creatinine": {
							"type": ["number", "null"],
							"minimum": 0,
							"maximum": 20,
							"description": "Serum creatinine level in mg/dL"
						},
						"eGFR": {
							"type": ["number", "null"],
							"minimum": 0,
							"maximum": 200,
							"description": "Estimated Glomerular Filtration Rate in mL/min/1.73mÂ²"
						},
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date"
						},
						"nephrologist": { "type": ["string", "null"] }
					},
					"required": ["previousDialysis"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"previousDialysis": { "const": false }
						}
					},
					"then": {
						"properties": {
							"previousDialysis": {},
							"kidneyMedications": { "maxItems": 0 },
							"creatinine": { "const": null },
							"eGFR": { "const": null },
							"lastHospitalization": { "const": null },
							"nephrologist": { "const": null }
						}
					}
				},

				"CAD": {
					"type": "object",
					"$comment": "Coronary Artery Disease",
					"properties": {
						"NYHA_class": {
							"type": ["string", "null"],
							"$comment": "New York Heart Association (NYHA) Functional Classification",
							"description": "NYHA functional classification of heart failure severity (I=mild, IV=severe)",
							"enum": ["I", "II", "III", "IV", null]
						},
						"degreeOfStenosis": {
							"type": "object",
							"properties": {
								"measuredByAngiography": { "type": ["string", "null"] },
								"type": {
									"type": ["string", "null"],
									"enum": ["Type I", "Type II", null]
								}
							},
							"additionalProperties": false
						},
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date"
						},
						"cardiologist": { "type": ["string", "null"] }
					},
					"additionalProperties": false
				},

				"CHF": {
					"type": "object",
					"$comment": "Congestive Heart Failure",
					"properties": {
						"type": {
							"type": ["string", "null"],
							"description": "Heart failure type: HFpEF (preserved ejection fraction), HFmEF (mid-range), HFrEF (reduced)",
							"enum": ["HFpEF", "HFmEF", "HFrEF", null]
						},
						"echo": {
							"type": "object",
							"properties": {
								"date": {
									"type": ["string", "null"],
									"format": "date",
									"$comment": "ISO 8601 format: YYYY-MM-DD",
									"description": "Date of echocardiogram"
								},
								"ejectionFractionPercent": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 100,
									"description": "Left ventricular ejection fraction as a percentage"
								}
							},
							"additionalProperties": false
						},
						"medications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"GDMT_medications": {
							"$comment": "Goal-directed medical therapy",
							"type": "array",
							"items": { "type": "string" }
						},
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date"
						},
						"cardiologist": { "type": ["string", "null"] }
					},
					"additionalProperties": false
				},

				"diabetes": {
					"type": "object",
					"properties": {
						"diagnosed": { "type": "boolean" },
						"medications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"endocrinologist": { "type": ["string", "null"] }
					},
					"required": ["diagnosed"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"diagnosed": { "const": false }
						}
					},
					"then": {
						"properties": {
							"diagnosed": {},
							"medications": { "maxItems": 0 },
							"endocrinologist": { "const": null }
						}
					}
				},

				"strokes": {
					"type": "object",
					"properties": {
						"historyOfStroke": { "type": "boolean" },
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date",
							"$comment": "ISO 8601 format: YYYY-MM-DD"
						},
						"medications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"neurologist": { "type": ["string", "null"] }
					},
					"required": ["historyOfStroke"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"historyOfStroke": { "const": false }
						}
					},
					"then": {
						"properties": {
							"historyOfStroke": {},
							"lastHospitalization": { "const": null },
							"medications": { "maxItems": 0 },
							"neurologist": { "const": null }
						}
					}
				},

				"atrialFibrillation": {
					"type": "object",
					"properties": {
						"diagnosed": { "type": "boolean" },
						"rateControlMedications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"anticoagulation": { "type": ["string", "null"] },
						"lastHospitalization": {
							"type": ["string", "null"],
							"format": "date",
							"$comment": "ISO 8601 format: YYYY-MM-DD"
						},
						"cardiologist": { "type": ["string", "null"] }
					},
					"required": ["diagnosed"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"diagnosed": { "const": false }
						}
					},
					"then": {
						"properties": {
							"diagnosed": {},
							"rateControlMedications": { "maxItems": 0 },
							"anticoagulation": { "const": null },
							"lastHospitalization": { "const": null },
							"cardiologist": { "const": null }
						}
					}
				},

				"osteoporosis": {
					"type": "object",
					"properties": {
						"diagnosed": { "type": "boolean" },
						"timeOfDiagnosis": { "type": ["string", "null"] },
						"boneScanResults": { "type": ["string", "null"] },
						"previousBirthControlUse": { "type": ["string", "null"] }
					},
					"required": ["diagnosed"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"diagnosed": { "const": false }
						}
					},
					"then": {
						"properties": {
							"diagnosed": {},
							"timeOfDiagnosis": { "const": null },
							"boneScanResults": { "const": null },
							"previousBirthControlUse": { "const": null }
						}
					}
				},

				"dementia": {
					"type": "object",
					"properties": {
						"diagnosed": { "type": "boolean" },
						"followedBy": { "type": ["string", "null"] },
						"medications": {
							"type": "array",
							"items": { "type": "string" }
						},
						"gerontologist": { "type": ["string", "null"] }
					},
					"required": ["diagnosed"],
					"additionalProperties": false,
					"if": {
						"properties": {
							"diagnosed": { "const": false }
						}
					},
					"then": {
						"properties": {
							"diagnosed": {},
							"followedBy": { "const": null },
							"medications": { "maxItems": 0 },
							"gerontologist": { "const": null }
						}
					}
				},

				"otherPastMedicalHistory": {
					"type": "array",
					"items": { "type": "string" }
				},

				"previouslyHealthy": { "type": "boolean" }
			},
			"required": ["previouslyHealthy"],
			"additionalProperties": false
		},

		"allergies": {
			"type": "object",
			"properties": {
				"list": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"allergen": { "type": "string" },
							"reaction": { "type": "string" },
							"onset": {
								"type": "string",
								"enum": ["childhood", "adolescence", "adult"]
							}
						},
						"required": ["allergen", "reaction", "onset"],
						"additionalProperties": false
					}
				},
				"epipenPrescribed": { "type": "boolean" },
				"otherAntiAllergyMeds": {
					"type": "array",
					"items": { "type": "string" }
				},
				"noKnownDrugAllergies": { "type": "boolean" }
			},
			"required": ["epipenPrescribed", "noKnownDrugAllergies"],
			"additionalProperties": false
		},

		"socialHistory": {
			"type": "object",
			"properties": {
				"smoking": {
					"type": "object",
					"properties": {
						"status": {
							"type": "string",
							"enum": ["never", "previous", "current"]
						},
						"previous": {
							"type": "object",
							"properties": {
								"packsPerDay": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 10
								},
								"years": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 100
								},
								"quitYearsAgo": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 100
								}
							},
							"additionalProperties": false
						},
						"current": {
							"type": "object",
							"properties": {
								"packsPerDay": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 10
								},
								"startedYearsAgo": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 100
								},
								"type": {
									"type": "array",
									"items": {
										"type": "string",
										"enum": ["cigarettes", "marijuana"]
									}
								}
							},
							"additionalProperties": false
						}
					},
					"required": ["status"],
					"additionalProperties": false
				},

				"alcohol": {
					"type": "object",
					"properties": {
						"status": {
							"type": "string",
							"enum": ["never", "previous", "drinks"]
						},
						"drinksPerDay": {
							"type": ["number", "null"],
							"minimum": 0,
							"maximum": 50
						},
						"previous": {
							"type": "object",
							"properties": {
								"drinksPerDay": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 50
								},
								"quitYearsAgo": {
									"type": ["number", "null"],
									"minimum": 0,
									"maximum": 100
								}
							},
							"additionalProperties": false
						}
					},
					"required": ["status"],
					"additionalProperties": false
				},

				"recreationalDrugs": {
					"type": "object",
					"properties": {
						"used": { "type": "boolean" },
						"substances": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"substance": { "type": "string" },
									"useFrequency": { "type": ["string", "null"] },
									"startedYearsAgo": {
										"type": ["number", "null"],
										"minimum": 0,
										"maximum": 100
									},
									"finishedYearsAgo": {
										"type": ["number", "null"],
										"minimum": 0,
										"maximum": 100
									}
								},
								"required": ["substance"],
								"additionalProperties": false
							}
						}
					},
					"required": ["used"],
					"additionalProperties": false
				},

				"livingSituation": {
					"type": "object",
					"properties": {
						"livesWith": {
							"type": "array",
							"items": {
								"type": "string",
								"enum": [
									"alone",
									"family",
									"spouse",
									"partner",
									"children",
									"pets",
									"roommate",
									"caregiver",
									"assisted living staff",
									"other"
								]
							}
						},
						"typeOfResidence": {
							"type": ["string", "null"],
							"enum": ["apartment", "house", null]
						},
						"hazards": {
							"type": "object",
							"properties": {
								"leadPipes": { "type": "boolean" },
								"insulationIssues": { "type": "boolean" }
							},
							"additionalProperties": false
						}
					},
					"additionalProperties": false
				},

				"work": {
					"type": "object",
					"properties": {
						"typeOfWork": { "type": ["string", "null"] },
						"standingWalkingRequired": { "type": ["string", "null"] },
						"exerciseRoutine": { "type": ["string", "null"] }
					},
					"additionalProperties": false
				}
			},
			"additionalProperties": false
		},

		"familyHistory": {
			"type": "object",
			"properties": {
				"conditions": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"condition": { "type": "string" },
							"familyMembers": {
								"type": "array",
								"items": {
									"type": "string",
									"enum": ["mother", "father", "sibling", "child", "other"]
								}
							}
						},
						"required": ["condition", "familyMembers"],
						"additionalProperties": false
					}
				},
				"unknownFamilyHistory": { "type": "boolean" }
			},
			"required": ["unknownFamilyHistory"],
			"additionalProperties": false
		}
	},
	"required": [
		"pastMedicalHistory",
		"allergies",
		"socialHistory",
		"familyHistory"
	],
	"additionalProperties": false
}
